parameters:
  helfi_navigation.request_timeout: 15
  helfi_navigation.vault_key: 'helfi_navigation'
services:
  logger.channel.helfi_navigation:
    parent: logger.channel_base
    arguments: ['helfi_navigation']
  helfi_navigation.external_menu_tree_builder:
    class: Drupal\helfi_navigation\ExternalMenuTreeBuilder
    arguments:
      - '@helfi_api_base.internal_domain_resolver'
      - '@request_stack'
  helfi_navigation.api_manager:
    parent: helfi_api_base.api_client_base
    class: Drupal\helfi_navigation\ApiManager
    arguments:
      - '@logger.channel.helfi_navigation'
      - '@helfi_navigation.api_authorization'
      - { timeout: '%helfi_navigation.request_timeout%' }
  helfi_navigation.menu_manager:
    class: Drupal\helfi_navigation\MainMenuManager
    arguments:
      - '@language_manager'
      - '@config.factory'
      - '@helfi_navigation.api_manager'
      - '@helfi_navigation.menu_tree_builder'
      - '@account_switcher'
  helfi_navigation.menu_tree_builder:
    class: Drupal\helfi_navigation\Menu\MenuTreeBuilder
    arguments:
      - '@entity_type.manager'
      - '@helfi_api_base.internal_domain_resolver'
      - '@menu.link_tree'
      - '@plugin.manager.menu.link'
      - '@event_dispatcher'
  helfi_navigation.cache_warmer:
    class: Drupal\helfi_navigation\CacheWarmer
    arguments:
      - '@tempstore.shared'
      - '@language_manager'
      - '@cache_tags.invalidator'
      - '@helfi_navigation.api_manager'
  helfi_navigation.api_authorization:
    parent: helfi_api_base.vault_authorizer
    arguments:
      - '%helfi_navigation.vault_key%'
      - 'helfi_navigation.api:key'
